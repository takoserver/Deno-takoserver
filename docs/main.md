# takos protocpl仕様

takosはTrustworthy Alternative Knowledge-sharing Open-source Systemの略です

takosは分散型チャット用のプロトコルです。
matrixに近いものですが、matrixではLINEのようなものを作れないので策定。
ちなみにdocsはmatrixを参考に策定しています

## 理念

既存の中央集権的なメッセージングサービスとは異なり、各サーバーで競争が行われ、消費者にとって良い機能が提供されることを目指しています。 ブロックチェーンではなく、「サーバー」を残したのはブロックチェーンでは過度に匿名性が保たれ、検閲が困難になるため、悪意あるユーザーが増えると考えたためです。 このソフトウェアの分散型機能では中央集権的な情報の支配を打開するものであり、匿名性を向上させるものではありません。 理想を追い求めるのではなく、現実的にユーザーにとって最適な選択肢を提供することを目指しています。

## api

matrixとは違い、クライアントapiは独自のものをそれぞれのサーバーが策定します。 takos protocolが策定するのはサーバ間apiのみである

foundation api(link)

## メッセージ暗号化の規格



## takos foundation apiが従う原則
- REST API
- シンプルで他のサービスへの依存関係のない
- オープン

## takosの提供する機能
- 分散的にメッセージを保存するが、チャットルームの管理の自治権は特定のサーバーが保有する
- メッセージの暗号化と署名
- Groupの管理
- Groupの権限システム

## アーキテクチャ

takosはイベントがあるたびに、他のサーバーへapiで伝えてます。
サーバー間で共有するデーターは最小限であり共有する必要のないデータはクライアントから各サーバーへgetします。
例えば、メッセージはidと送信者のみを保存し、idをもとに各サーバーからデータを取得します。

## ユーザー

ユーザーidによりuserNameとサーバーを認識します。

```
userName@domain
```

## デバイス
デバイスにはそれぞれ一意の`device_id`が割り振られ、鍵共有の識別に充てられます。
uuid v7です

## イベント
takosのサーバー間apiで通信はすべてイベントidが識別されます。
一定期間でかつ一意のeventIdでのみリクエストを受け付ける

## 部屋の構造
ルームにはそれぞれidがあり、識別します。また、メッセージに含めることで改ざんを防ぎます
### group/publicGroupの場合
```
uuidv7@domain
```

### friend(DM)の場合
```
friendId
```

Group/pub

