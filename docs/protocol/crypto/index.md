# Takos Encrypt Ink (分散型チャットサービスの暗号化システム)

この分散型システムは、Mastodonのようなサーバーアーキテクチャを採用しています。以下に、このシステムの暗号化プロセスと鍵管理について説明します。

### 鍵の命名と構造

1. **アカウント鍵 (account_key)**
   - 各アカウントには公開鍵と秘密鍵のペアが存在します。
   - これらの鍵を `account_key` と呼びます。
   - 暗号用と署名用の2つの鍵があります。

2. **ルーム鍵 (room_key)**
   - 各チャットルームには、参加する各アカウントが秘密鍵と公開鍵を持ちます。
   - これらの鍵を `room_key` と呼びます。

3. **デバイス鍵 (device_key)**
   - 各デバイスには公開鍵と秘密鍵のペアが存在します。
   - これらの鍵を `device_key` と呼びます。

### account_key

account_keyは、ユーザーのアカウント同士の信頼関係を確立します。
アカウント作成時またはセットアップ時に、クライアントで鍵ペアを生成し、公開鍵をアップロードします。

### room_key

account_keyの信用を利用して、room_keyの公開鍵の正当性を保証します。
信用するユーザーのroom_keyを利用して共通鍵を生成し、メッセージを暗号化します。
messageidを含めることにより、共通鍵の解読を防ぎます。

### 大人数のグループチャットでの推奨事項

- **セキュリティと信頼性:**
  - 大人数のグループチャットでは、account_keyの整合性を確認するのが難しいため、サーバーを信頼することを推奨します。
  - しかし、セキュリティを重視する場合は、直接会ってaccount_keyとroom_keyの整合性を確認することをおすすめします。

このシステムにより、分散型チャットサービスにおける暗号化と鍵管理が強化され、ユーザーのプライバシーとデータの安全性が確保されます。
