# masterKeyの信用

masterKeyを検知すると、デバイスに未承認のmasterKeyとして登録される。その時サーバーに本物か確認する。
新しいmasterKeyを発見した場合そのユーザーの所属するサーバーに確認して更新する。

登録する場合、デバイスに日付とmasterKeyのハッシュを保存する。
共有する場合、デバイスに日付とmasterKeyのハッシュを保存し、サーバーに署名して他のクライアントにも保存する。

## サーバーによる偽造の防止

クライアント同士でmasterKeyのハッシュを見せあい一致すれば本物と認め、デバイスに保存し、サーバーに署名して他のクライアントにも保存する。

認証しているユーザーのみの部屋は安全であることが保証される。

## masterKeyによる検証

新しいmasterKeyを発見した時刻以降は前のmasterKeyをを使って検証することはできない。
