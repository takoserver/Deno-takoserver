# Takos Encrypt Ink

## 概要
**Takos Encrypt Ink**は、Takos Protocolの一部として設計された暗号化システムで、民主的な分散型チャットサービスにおけるセキュリティとプライバシーを強化するための規格です。本プロトコルは、複数の鍵を使用してメッセージの署名、暗号化、復号化を行い、各ユーザーのデータを保護します。

## 鍵の種類

### 1. アカウント鍵 (Account Key)
- **役割:** 各アカウントにひとつ割り当てられる鍵で、メッセージや他の鍵の署名に使用されます。
- **サーバー:** 公開鍵のみがサーバーにアップロードされます。
- **信頼性:** ユーザー同士は、直接会うか信頼できる通信を通じて、鍵の改ざんがないことを確認し、信頼を構築します。サーバーが信頼できる場合、この手順をスキップできます。
- **更新:** 新しい公開鍵と、各Session鍵で暗号化された秘密鍵を、前のアカウント鍵で署名し、サーバーにアップロードします。鍵が紛失または漏洩した場合、署名なしでアップロードし、再び信頼を構築する必要があります。
- **アルゴリズム:** rsassa-pass

### 2. セッション鍵 (Session Key)
- **役割:** 主にアカウント鍵の更新に使用され、各デバイスが一つずつ所有します。
- **サーバー:** 公開鍵をアカウント鍵で署名してサーバーにアップロードします。
- **更新:** アカウント鍵を更新するデバイスが署名された公開鍵を使用して暗号化し、前の鍵で署名したものをアップロードします。
- **アルゴリズム:** rsa-oaep

### 3. デバイス鍵 (Device Key)
- **役割:** 各デバイスの紛失リスクを低減するために使用します。
- **サーバー:** アカウント鍵で署名された秘密鍵と公開鍵をサーバーにアップロードし、秘密鍵で暗号化して各鍵を保存します。
- **紛失対策:** デバイスを紛失した場合、デバイス鍵を削除することで、リスクを減らすことができます。この機能は、ユーザーの選択によって使用できます。
- **アルゴリズム:** rsa-oaep

### 4. ルーム鍵 (Room Key)
- **役割:** トークルームに参加しているユーザーごとに一つ割り当てられます。
- **サーバー:** 公開鍵はアカウント鍵で署名され、サーバーにアップロードされます。秘密鍵はセッション鍵で暗号化され、アカウント鍵で署名されて各デバイスと共有されます。
- **メッセージの送信:** 各ユーザーの公開鍵で暗号化し、アカウント鍵で署名してメッセージを送信します。
- **アルゴリズム:** rsa-oaep

### 5. グループ鍵 (Group Key)
- **役割:** 共通鍵で、トークルーム内のメンバー全員が共有する鍵です。各ルーム鍵で暗号化および署名されて配布されます。
- **更新:** 二週間に一度の更新が推奨されており、1ヶ月間更新が行われない場合には警告が発せられます。鍵の更新は原則自動で行われ、最初の二週間から三週間はリーダーが、残りの一週間は他のメンバーが担当します。デバイスがオンラインの際に更新され、サーバーにアップロードされます。

アルゴリズム AES

- **個人チャット:** 個人チャットにおいては、ルーム鍵を使用して通信が暗号化されます。

---

このドキュメントは、Takos Encrypt Inkの機能と設計に関する包括的なガイドラインです。必要に応じて、更なる技術的な詳細や実装手順については、プロトコルの追加ドキュメントを参照してください。

---