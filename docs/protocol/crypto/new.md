次のプロトコルの鍵の作成、署名、暗号化、鍵が本物かどうかなどを確認するモジュールをjavaScriptで作成

分散型チャットサービス暗号化プロトコルの案です。 **暗号化プロトコル:**

1. **鍵の概要:** 量子コンピューター対策のために、pcqアルゴリズムml-kem,
   ml-dsaと共通鍵のaesを利用する。
   - **masterKey**: アカウントに一つだけ存在する全ての鍵の信頼の根幹となる鍵。
     - **役割:** 各デバイスの**identityKey**を署名し、信頼の連鎖を確立する。

   - **identityKey**:
     各デバイスに存在する署名用の鍵。メッセージや**roomKey**を署名する。
     - **役割:** **masterKey**によって署名され、デバイスの正当性を保証する。

   - **accountKey**: roomKey送信のために利用する、暗号化用の鍵。
     - **役割:** アカウント間で**roomKey**を共有するために利用される。
       **masterKey**によって署名される。

   - **shareKey**: デバイス間で**accountKey**を共有するための公開鍵。

   - **roomKey**:
     各デバイスで各ルームごとに生成される暗号化用の共通鍵。**accountKey**で他のユーザーに送られる。

2. **roomKeyの署名**

3. **鍵の生成と管理:**

   - **identityKey**は各デバイスで生成され、**masterKey**によって署名される。
   - **accountKey**は**masterKey**によって署名される。
   - **roomKey**は各ルームごとにデバイスが生成し、必要に応じて定期的に更新する。

4. **メッセージの送信手順:**

   - **RoomKeyの共有:**
     - 送信者は受信者の**accountKey**の公開鍵で**roomKey**を暗号化する。
     - 暗号化した**roomKey**を受信者に送信する。

   - **メッセージの暗号化と送信:**
     - メッセージを**roomKey**で暗号化する。
     - 暗号化したメッセージを受信者に送信する。

5. **メッセージの受信手順:**

   - **RoomKeyの復号:**
     - 受信者は自分の**accountKey**の秘密鍵で**roomKey**を復号する。

   - **メッセージの復号と検証:**
     - **roomKey**でメッセージを復号する。
     - 送信者の**identityKey**で署名を検証し、メッセージの真正性を確認する。

6. **デバイス間の鍵共有:**

   - **shareKey**を使用して**accountKey**を共有する。

7. **鍵の更新:**

   - **masterKey**、**identityKey**、**accountKey**、**roomKey**は定期的に更新し、セキュリティを強化する。
   - 更新時には新しい鍵を生成し、適切な方法で他のデバイスやユーザーと共有する。
